# Définir le nom et le chemin de l'OU
$OUName = "Ordinateurs"
$OUPath = "OU=$OUName,DC=ecosolarsolution,DC=local"

# Vérifier si l'OU existe déjà
if (-not (Get-ADOrganizationalUnit -Filter "DistinguishedName -eq '$OUPath'")) {
    New-ADOrganizationalUnit -Name $OUName -Path "DC=ecosolarsolution,DC=local"
    Write-Host "OU $OUName créée avec succès."
} else {
    Write-Host "OU $OUName existe déjà."
}

# Ajouter 60 ordinateurs dans l'OU
For ($i=1; $i -le 60; $i++) {
    $ComputerName = "ECL_" + ($i.ToString("000")) # Génère ECL_001 à ECL_060
    $ComputerPath = "CN=$ComputerName,$OUPath"
    
    # Vérifier si l'ordinateur existe déjà
    if (-not (Get-ADComputer -Filter {Name -eq $ComputerName})) {
        New-ADComputer -Name $ComputerName -Path $OUPath -Enabled $true
        Write-Host "Ordinateur $ComputerName créé avec succès."
    } else {
        Write-Host "L'ordinateur $ComputerName existe déjà, il sera ignoré."
    }
}
