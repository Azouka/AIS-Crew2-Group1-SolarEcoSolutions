# Importer le module Active Directory
Import-Module ActiveDirectory

# D√©finir le domaine de base
$domain = "DC=ecosolarsolution,DC=local"

# Liste des utilisateurs
$users = @(
    @{GivenName="Marcy"; Surname="Hyatt"; SamAccountName="mhyatt"; OU="Atelier"; Description="Technicienne maintenance 1"},
    @{GivenName="Jean"; Surname="Vancleave"; SamAccountName="jvancleave"; OU="Atelier"; Description="Technicien maintenance 2"}
    # Ajoute tous les autres utilisateurs ici...
)

# Initialiser un compteur pour nommer les PC
$counter = 1  

foreach ($user in $users) {
    $ouPath = "OU=$($user.OU),$domain"
    $computerName = "ECL_" + $counter.ToString("D3")  # Format ECL_001, ECL_002, etc.

    # Cr√©er l'ordinateur dans Active Directory
    try {
        New-ADComputer `
            -Name $computerName `
            -SamAccountName $computerName `
            -Path $ouPath `
            -Enabled $true `
            -Description "Ordinateur associ√© √† $($user.SamAccountName)" `
            -OperatingSystem "Windows 10"

        Write-Host "‚úÖ Ordinateur $computerName cr√©√© avec succ√®s."
    }
    catch {
        Write-Host "‚ùå Erreur lors de la cr√©ation de l'ordinateur $computerName : $($_.Exception.Message)"
    }

    # Associer l'utilisateur √† l'ordinateur
    try {
        Set-ADComputer -Identity $computerName -Description "Ordinateur pour $($user.SamAccountName)"
        Write-Host "üîó Association de $computerName avec $($user.SamAccountName) r√©ussie."
    }
    catch {
        Write-Host "‚ùå Erreur lors de l'association de $computerName avec $($user.SamAccountName) : $($_.Exception.Message)"
    }

    # Incr√©menter le compteur
    $counter++
}

Write-Host "üéØ Tous les ordinateurs ont √©t√© cr√©√©s et associ√©s aux utilisateurs."
