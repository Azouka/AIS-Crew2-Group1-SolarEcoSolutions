# Définir le domaine racine
$domain = "DC=ecosolarsolution,DC=local"

# Liste des utilisateurs et leurs OUs correspondantes
$users = @(
    @{FirstName="Wally"; LastName="Adam"; OU="Direction"},
    @{FirstName="Herminia"; LastName="Oliva"; OU="Direction"},
    @{FirstName="Elijah"; LastName="Blakley"; OU="Informatique"},
    @{FirstName="Nguyet"; LastName="Catlett"; OU="Informatique"},
    @{FirstName="Phyllis"; LastName="Biondo"; OU="Production"},
    @{FirstName="Davie"; LastName="Ivan"; OU="Atelier"},
    @{FirstName="Hyatt"; LastName="Marcy"; OU="Atelier"},
    @{FirstName="Vancleave"; LastName="Jean"; OU="Atelier"},
    @{FirstName="Penning"; LastName="Sharilyn"; OU="Logistique/approvisionnement"},
    @{FirstName="Przybyla"; LastName="Leonardo"; OU="Logistique/approvisionnement"},
    @{FirstName="Bradwell"; LastName="Teri"; OU="Logistique/approvisionnement"},
    @{FirstName="Galasso"; LastName="Dominique"; OU="Logistique/approvisionnement"},
    @{FirstName="Waltrip"; LastName="Antoine"; OU="Logistique/approvisionnement"},
    @{FirstName="Twiford"; LastName="Isabelle"; OU="Production"},
    @{FirstName="Bragdon"; LastName="Elene"; OU="Production"},
    @{FirstName="Bakley"; LastName="Sandra"; OU="Production"},
    @{FirstName="Rubalcava"; LastName="Jérémy"; OU="Production"},
    @{FirstName="Schewe"; LastName="Maye"; OU="Production"},
    @{FirstName="Isenberg"; LastName="Edmond"; OU="Production"},
    @{FirstName="Vanarsdale"; LastName="Luc"; OU="Production"},
    @{FirstName="Tokarski"; LastName="Laurent"; OU="Production"},
    @{FirstName="Plamondon"; LastName="Elise"; OU="Production"},
    @{FirstName="Shoaf"; LastName="Marion"; OU="Production"},
    @{FirstName="Garber"; LastName="Michel"; OU="Production"},
    @{FirstName="Blalock"; LastName="Cassandra"; OU="Production"},
    @{FirstName="Yarberry"; LastName="Julie"; OU="Production"},
    @{FirstName="Gutter"; LastName="Serena"; OU="Production"},
    @{FirstName="Bolden"; LastName="Damien"; OU="Production"},
    @{FirstName="Chilcott"; LastName="Baptiste"; OU="Production"},
    @{FirstName="Cosme"; LastName="Melissa"; OU="Production"},
    @{FirstName="Hae"; LastName="Patrick"; OU="Production"},
    @{FirstName="Towers"; LastName="Thibault"; OU="Production"},
    @{FirstName="Larock"; LastName="Caroline"; OU="Production"},
    @{FirstName="Demelo"; LastName="Pierre"; OU="Production"},
    @{FirstName="Gerardo"; LastName="Lucien"; OU="Production"},
    @{FirstName="Ria"; LastName="Mathis"; OU="Production"},
    @{FirstName="Letts"; LastName="Valérie"; OU="R&D/qualité"},
    @{FirstName="Babb"; LastName="Violaine"; OU="R&D/qualité"},
    @{FirstName="Velva"; LastName="William"; OU="R&D/qualité"}
)

# Assigner chaque utilisateur à son OU
foreach ($user in $users) {
    $username = "$($user.FirstName).$($user.LastName)"
    $userDN = "CN=$username,OU=$($user.OU),$domain"
    
    $existingUser = Get-ADUser -Filter "GivenName -eq '$($user.FirstName)' -and Surname -eq '$($user.LastName)'" -ErrorAction SilentlyContinue
    
    if ($existingUser) {
        Move-ADObject -Identity $existingUser.DistinguishedName -TargetPath "OU=$($user.OU),$domain"
        Write-Output "Utilisateur $username déplacé dans OU=$($user.OU)."
    } else {
        Write-Output "Utilisateur $username non trouvé dans l'AD."
    }
}
