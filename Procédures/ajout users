
$domain = "DC=ecosolarsolution,DC=local"

$OUs = @(
    "Direction",
    "Informatique",
    "Atelier",
    "Logistique/approvisionnement",
    "Production",
    "R&D/qualité",
    "Service commercial",
    "Expédition",
    "Dpt Administratif & Financier"
)

foreach ($OU in $OUs) {
    $ouPath = "OU=$OU,$domain"
    if (-not (Get-ADOrganizationalUnit -Filter "DistinguishedName -eq '$ouPath'" -ErrorAction SilentlyContinue)) {
        New-ADOrganizationalUnit -Name $OU -Path $domain -ProtectedFromAccidentalDeletion $true
        Write-Output "OU '$OU' créée avec succès."
    } else {
        Write-Output "OU '$OU' existe déjà."
    }
}
