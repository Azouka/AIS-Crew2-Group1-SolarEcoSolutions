# Définir le nom de domaine
$domain = "Ecosolarsolution.local"

# Définir le préfixe des noms d'ordinateurs
$prefix = "ECL_"

# Définir l'OU (Unité Organisationnelle) où les ordinateurs seront créés
$ou = "OU=Computers,DC=Ecosolarsolution,DC=local"  # Remplacez par l'OU souhaitée

# Boucle pour créer 60 ordinateurs
for ($i = 1; $i -le 60; $i++) {
    # Formater le numéro de l'ordinateur (ex: 001, 002, ..., 060)
    $computerNumber = "{0:D3}" -f $i

    # Créer le nom de l'ordinateur
    $computerName = "$prefix$computerNumber"

    # Créer l'objet ordinateur dans l'AD
    try {
        New-ADComputer -Name $computerName -Path $ou -Enabled $true
        Write-Host "Ordinateur créé : $computerName"
    } catch {
        Write-Host "Erreur lors de la création de l'ordinateur $computerName : $_"
    }
}

Write-Host "Création des ordinateurs terminée."
