# Vérification du module Active Directory
if (-not (Get-Module -Name ActiveDirectory -ListAvailable)) {
    Write-Host "Le module Active Directory n'est pas installé. Veuillez l'installer avant d'exécuter ce script."
    exit
}

# Définition des paramètres
$domain = "Ecosolarsolution.local"
$ou = "OU=Computers,DC=Ecosolarsolution,DC=local"

# Création des 60 ordinateurs
for ($i = 1; $i -le 60; $i++) {
    $computerName = ("ECL_{0:D3}" -f $i)  # Génération des noms ECL_001 à ECL_060

    # Vérification si l'ordinateur existe déjà
    if (Get-ADComputer -Filter {Name -eq $computerName}) {
        Write-Host "L'ordinateur $computerName existe déjà, il sera ignoré." -ForegroundColor Yellow
    } else {
        # Création de l'ordinateur dans l'OU Computers
        New-ADComputer -Name $computerName -Path $ou -Enabled $true -PassThru
        Write-Host "Ordinateur $computerName créé avec succès." -ForegroundColor Green
    }
}
