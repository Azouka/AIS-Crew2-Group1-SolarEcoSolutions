try {
    New-ADComputer `
        -Name $computerName `
        -SamAccountName $computerAccountName `
        -Path $ouPath `
        -Enabled $true `
        -Description "Ordinateur associé à l'utilisateur $($user.SamAccountName)" `
        -OperatingSystem "Windows 10"
    Write-Host "Ordinateur $computerName créé avec succès."
}
catch {
    Write-Host "Erreur lors de la création de l'ordinateur $computerName: $($_.Exception.Message)"
}

try {
    Set-ADComputer -Identity $computerAccountName -Description "Ordinateur pour $($user.SamAccountName)"
    Write-Host "L'ordinateur $computerName a été associé à l'utilisateur $($user.SamAccountName)."
}
catch {
    Write-Host "Erreur lors de l'association de l'ordinateur $computerName avec l'utilisateur $($user.SamAccountName): $($_.Exception.Message)"
}
